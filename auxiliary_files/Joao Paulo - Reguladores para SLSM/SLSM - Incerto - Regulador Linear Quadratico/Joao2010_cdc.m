%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%                           Dados do Sistema                              %
%            Sistema Incerto com Matriz de Transição Nominal              %
%                                                                         %
% Exemplo do Artigo "Recursive Robust Regulator for Discrete-time MJLS    %
% via Penalty Game Approach" de J.P. Cerri, M.H. Terra and J.Y. Ishihara  %
% (2010).                                                                 %
%                                                                         %
% x(k+1) = ( F + DeltaF )(:,:,i) * x(k) + ( G + DeltaG )(:,:,i) * u(k)    %
% DeltaA = H(:,:,i) * delta_k * Ef(:,:,i)                                 %
% DelatB = H(:,:,i) * delta_k * Eg(:,:,i)                                 %
% Prob (Matriz de transição)                                              %
% Q, R (Matrizes de ponderação)                                           %
% P  (Solucao da Equação de Riccati)                                      %
%                                                                         %
%%=======================================================================%%
% Daiane C. Bortolin                                       Outubro / 2016 %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Prob = [ 0.63 0.37 ; 0.30 0.70 ]; 
                  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
%%%                        Dados do Sistema                             %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

x0  = [ 1 ; -1 ; 2];
 
% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - %

F(:,:,1) = [ 1 1 1 ; -2.5 3.2 1.2 ; 1.4 1.6 2 ];

F(:,:,2) = [ 1 1 1 ; -2.7 0.4 2.1 ; -3.4 2.5 4.8 ];

% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - %

G(:,:,1) = [ 1 0 1 ; 0 1 2 ; 1 1 1 ];

G(:,:,2) = G(:,:,1);

% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - %
 
  H(:,:,1) = [  0.21 ; -0.17 ;  0.11 ];
  
  H(:,:,2) = [ -0.12 ; -0.33 ; -0.21 ];

%%% Dados da Tese do João
%   H(:,:,1) = [ 1.47 ; -1.19 ; 0.77 ];
%   H(:,:,2) = [ 0.60 ;  1.65 ; 1.05 ];

% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - %

Ef(:,:,1) = [ .11 .00 .05 ];

Ef(:,:,2) = [ .80 .00 .12 ];

% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - %

Eg(:,:,1) = [ .00 .26 .95 ];

Eg(:,:,2) = [ .25 .00 .00 ];

% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - %

Q(:,:,1) = [ 3.60 -3.80 0 ; -3.80 4.87 0 ; 0 0 1 ];

Q(:,:,2) = [ 2.9 -2.2 0 ; -2.2 2.5 0 ; 0 0 2 ];

% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - %

R(:,:,1) = 1.266 * eye(3);

R(:,:,2) = 1.165 * eye(3);

% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - %

% Dimensoes do problema

  s = size( Prob,1 );
  n = size( F(:,:,1),1 );
  m = size( G(:,:,1),2 );
  p = size( H(:,:,1),2 );
  q = size( Ef(:,:,1),1 );

% - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - %
 
% Riccati inicial
  for i = 1:s
      P(:,:,1,i) = eye(n);  
  end 
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%